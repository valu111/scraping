<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Vacantes</title>
  <link rel="stylesheet" href="stylos.css">
  <style>
    .error {
      color: red;
      font-size: 0.9em;
      margin-top: 4px;
    }
    .card {
      border: 1px solid #ccc;
      padding: 1em;
      margin-bottom: 1em;
      border-radius: 8px;
      max-width: 300px;
    }
  </style>
</head>
<body>

  <h1>Vacantes disponibles</h1>
  <div class="contenedor">
    <input type="text" id="busqueda" placeholder="Buscar un Empleo">
    <div id="error"></div>
  </div>
  
  <div id="cards"></div>

  <script>
    let jugadores = []; 
    const container = document.getElementById("cards");
    const inputBusqueda = document.getElementById("busqueda");
    const errorDiv = document.getElementById("error");

    
    function mostrarTarjetas(lista) {
      container.innerHTML = "";
      if (lista.length === 0) {
        container.innerHTML = `
          <div class="card">
            <img src="potaxie.jpg" alt="Sin resultados">
            <h2>No se encontraron resultados</h2>
            <h1>üëÅÔ∏èüëÑüëÅÔ∏è</h1>
            <p>Intenta con otros t√©rminos de b√∫squeda.</p>
          </div>
        `;
        return;
      }
      lista.forEach(j => {
        const imagen = j.imagen || "imagen_por_defecto.jpg";
        const titulo = j.titulo || "T√≠tulo no disponible";
        const subtitulo = j.subtitulo || "Subt√≠tulo no disponible";
        const texto = j.texto || "Descripci√≥n no disponible";
        const ubicacion = j.ubicacion || "Ubicaci√≥n no disponible";
        const estadoEmpleo = j.estadoEmpleo || "Estado no disponible";
        const enlace = j.enlace || "#";

        container.innerHTML += `
          <div class="card">
            <img src="${imagen}" alt="Imagen del empleo">
            <h1>T√≠tulo: ${titulo}</h1>
            <h3>Subt√≠tulo: ${subtitulo}</h3>
            <p>Texto: ${texto}</p>
            <p>Ubicaci√≥n: ${ubicacion}</p>
            <p>Estado del empleo: ${estadoEmpleo}</p>
            <a href="${enlace}" target="_blank">Ver m√°s</a>
          </div>
        `;
      });
    }

    // Mostrar tarjeta de error personalizada
    function mostrarTarjetaError(mensaje) {
      container.innerHTML = `
        <div class="card">
          <img src="potaxie.jpg" alt="Error de b√∫squeda">
          <h2>B√∫squeda inv√°lida</h2>
          <p>${mensaje}</p>
        </div>
      `;
    }

    
    fetch('empleos.json')
      .then(res => res.json())
      .then(data => {
        jugadores = data;
        container.innerHTML = "";
      })
      .catch(err => {
        container.innerHTML = "<p style='color:red;'>Error al cargar los datos.</p>";
      });

    
    function validarTexto(texto) {
      const regex = /^[A-Za-z√Å√â√ç√ì√ö√ú√ë√°√©√≠√≥√∫√º√±]+$/;
      return regex.test(texto);
    }

   
    inputBusqueda.addEventListener("keypress", (e) => {
      const char = e.key;
      const regex = /^[A-Za-z√Å√â√ç√ì√ö√ú√ë√°√©√≠√≥√∫√º√±]$/;
      if (!regex.test(char)) {
        e.preventDefault();
      }
    });

    
    inputBusqueda.addEventListener("input", () => {
      const textoBusqueda = inputBusqueda.value;

      if (textoBusqueda === "") {
        errorDiv.textContent = "";
        container.innerHTML = "";
        return;
      }

      if (!validarTexto(textoBusqueda)) {
        errorDiv.innerHTML = `<span class="error">Solo se permiten letras, sin espacios, n√∫meros ni caracteres especiales.</span>`;
        mostrarTarjetaError("No se permiten caracteres especiales, espacios o n√∫meros. Por favor, ingresa solo letras.");
        return;
      } else {
        errorDiv.textContent = "";
      }

      const textoBusquedaLower = textoBusqueda.toLowerCase();

      const filtrados = jugadores.filter(j => {
        return (
          (j.titulo && j.titulo.toLowerCase().includes(textoBusquedaLower)) ||
          (j.subtitulo && j.subtitulo.toLowerCase().includes(textoBusquedaLower)) ||
          (j.texto && j.texto.toLowerCase().includes(textoBusquedaLower)) ||
          (j.ubicacion && j.ubicacion.toLowerCase().includes(textoBusquedaLower)) ||
          (j.estadoEmpleo && j.estadoEmpleo.toLowerCase().includes(textoBusquedaLower))
        );
      });

      mostrarTarjetas(filtrados);
    });
  </script>

</body>
</html>